services:
  - type: worker
    name: arbitrage-telebot-scanner
    plan: starter
    env: python
    buildCommand: pip install -r requirements.txt
    startCommand: python arbitrage_telebot.py --role scanner --loop --interval 30
    healthCheckPath: /health
    envVars:
      - key: PROCESS_ROLE
        value: scanner
      - key: TG_BOT_TOKEN
        sync: false
      - key: TG_CHAT_IDS
        sync: false
      - key: INTERVAL_SECONDS
        value: "30"
      - key: LOG_BASE_DIR
        value: /var/log/arbitrage-telebot/scanner
      - key: LOG_BACKUP_DIR
        value: /var/log/arbitrage-telebot/scanner-backups
      - key: STATE_DB_URL
        sync: false

  - type: web
    name: arbitrage-telebot-api
    plan: starter
    env: python
    buildCommand: pip install -r requirements.txt
    startCommand: python arbitrage_telebot.py --role api --web --port $PORT
    healthCheckPath: /ready
    envVars:
      - key: PROCESS_ROLE
        value: api
      - key: WEB_AUTH_USER
        sync: false
      - key: WEB_AUTH_PASS
        sync: false
      - key: STATE_DB_URL
        sync: false

  - type: worker
    name: arbitrage-telebot-telegram
    plan: starter
    env: python
    buildCommand: pip install -r requirements.txt
    startCommand: python arbitrage_telebot.py --role telegram-worker --web --port $PORT
    healthCheckPath: /live
    envVars:
      - key: PROCESS_ROLE
        value: telegram-worker
      - key: TG_BOT_TOKEN
        sync: false
      - key: TG_CHAT_IDS
        sync: false
      - key: TG_ADMIN_IDS
        sync: false
      - key: STATE_DB_URL
        sync: false
